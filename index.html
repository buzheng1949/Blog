<!DOCTYPE html>
<html>

<head lang="en">
    <meta charset="UTF-8">
    <title>不正1943</title>
    <link rel="stylesheet" href="src/css/reset.css">
    <link rel="stylesheet" href="src/css/main.css">
    <script type="text/javascript" src="src/js/jquery-3.2.1.min.js"></script>


</head>
<body>
<!--头部-->
<header>
    <nav>
        <ul class="menu">
            <li class="logo"><a href="#">不正1943</a></li>
            <li id="search"><a href="#">搜索</a></li>
            <li id="about"><a href="#">关于</a></li>
            <li id="tags"><a href="#">标签</a></li>
            <li id="guidang"><a href="#">归档</a></li>
            <li id="sort"><a href="#">分类</a></li>
            <li id="home"><a href="#">首页</a></li>
        </ul>
    </nav>
</header>
<!--内容-->
<div class="content">
</div>
<!--尾部-->
<footer>尾部</footer>
<script>
    /**
     * 显示文章到首页
     *
     * @param article_title
     * @param article_tile_href
     * @param article_descripition
     * @param article_time
     *
     * @returns {number}
     */
    function appendArticleToHome(article_title, article_tile_href, article_descripition, article_time) {
        var article_list = $('<ol></ol>').addClass("article-list");
        var article_list_item = $('<li></li>').addClass("article-list-item");
        var article_list_item_name = $('<h3></h3>').addClass("article-list-item-name");
        var article_href = $('<a></a>').text(article_title).attr('href', article_tile_href);
        article_list_item_name.append(article_href);
        var article_list_item_descripition = $('<p></p>').addClass("article-list-item-descripition").text(article_descripition);
        var article_list_item_time = $('<p></p>').addClass("article-list-item-time").text(article_time);
        article_list_item.append(article_list_item_name, article_list_item_descripition, article_list_item_time);
        article_list.append(article_list_item);
        $(".content").append(article_list);
    }
    $(function () {
        var issues_url = "https://api.github.com/repos/buzheng1949/buzheng1949.github.io/issues";
        var issues_json;
        var description_length = 50;
        var time_length = 10;

        /**
         * 用户获取Json长度
         * @param jsonData
         * @returns {number}
         */
        function getJsonLength(jsonData) {
            var jsonLength = 0;
            for (var item in jsonData) {
                jsonLength++;
            }
            return jsonLength;
        }


        /**
         * 获取数据并展示在首页
         */
        $.getJSON(issues_url, function (json) {
            console.log(json)
            issues_json = json;
            for (var i = 0; i < getJsonLength(issues_json); i++) {
                var issue = issues_json[i];
                var title = issue.title;
                var url = issue.html_url;
                var des = issue.body.toString().substring(0, description_length)+"...";
                var time = issue.created_at.toString().substring(0,time_length);
                appendArticleToHome(title, url, des, time);
            }
        });
    });
</script>
</body>
</html>
